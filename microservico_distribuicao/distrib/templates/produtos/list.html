{% extends "base_dashboard.html" %}
{% block title %}Produtos · Distribuição{% endblock %}

{% block content %}
{% include "partials/_page_header.html" with title="Produtos" subtitle="Listagem e filtros" %}

<div class="card-glass p-3 mb-3">
  <form method="get" class="row gy-2 gx-2 align-items-end">
    <div class="col-sm-6 col-md-5 col-lg-4">
      <label class="form-label">Busca</label>
      <div class="input-group">
        <span class="input-group-text"><i class="fa fa-search"></i></span>
        <input type="text" name="q" value="{{ q }}" class="form-control" placeholder="Nome do produto">
      </div>
    </div>
    <div class="col-sm-4 col-md-3">
      <label class="form-label">Ativo</label>
      <select name="ativo" class="form-select">
        <option value="">Todos</option>
        <option value="sim" {% if ativo == "sim" %}selected{% endif %}>Sim</option>
        <option value="nao" {% if ativo == "nao" %}selected{% endif %}>Não</option>
      </select>
    </div>
    <div class="col-auto">
      <button class="btn btn-primary mt-4"><i class="fa fa-filter me-1"></i> Filtrar</button>
    </div>
  </form>
</div>

<div class="card-table">
  <div class="table-responsive">
    <table class="table table-hover table-striped align-middle mb-0">
      <thead>
        <tr>
          <th>Nome</th><th>Preço atual</th><th>Ativo</th><th class="text-center">Qtd. vendida</th><th>Criado em</th>
        </tr>
      </thead>
      <tbody>
      {% for p in produtos %}
        <tr>
          <td>{{ p.nome }}</td>
          <td>{{ p.preco_atual|default:"—" }}</td>
          <td>{% if p.ativo %}<span class="badge text-bg-success">Sim</span>{% else %}<span class="badge text-bg-danger">Não</span>{% endif %}</td>
          <td class="text-center">{{ p.qte_vendida|default:"0" }}</td>
          <td>{{ p.created_at|date:"d/m/Y H:i" }}</td>
        </tr>
      {% empty %}
        <tr><td colspan="5" class="text-center text-secondary py-4">Nenhum produto encontrado.</td></tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% include "partials/_pagination.html" with page_obj=page_obj %}
{% endblock %}
